# Generated by Django 5.2 on 2025-12-21 22:24

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('api', '0009_order_binance_order_id'),
        ('clients', '0003_alter_customuser_client'),
    ]

    operations = [
        migrations.RemoveField(
            model_name='eveningstar',
            name='client',
        ),
        migrations.RemoveField(
            model_name='hammer',
            name='client',
        ),
        migrations.RemoveField(
            model_name='hangingman',
            name='client',
        ),
        migrations.RemoveField(
            model_name='invertedhammer',
            name='client',
        ),
        migrations.RemoveField(
            model_name='morningstar',
            name='client',
        ),
        migrations.RemoveField(
            model_name='piercing',
            name='client',
        ),
        migrations.RemoveField(
            model_name='rectangle',
            name='client',
        ),
        migrations.RemoveField(
            model_name='shootingstar',
            name='client',
        ),
        migrations.RemoveField(
            model_name='triangle',
            name='client',
        ),
        migrations.CreateModel(
            name='MovingAverageConvergenceDivergence',
            fields=[
            ],
            options={
                'verbose_name': 'Moving Average Convergence Divergence',
                'verbose_name_plural': 'Moving Average Convergence Divergence',
                'proxy': True,
                'indexes': [],
                'constraints': [],
            },
            bases=('api.macdindicator',),
        ),
        migrations.CreateModel(
            name='RelativeStrengthIndex',
            fields=[
            ],
            options={
                'verbose_name': 'Relative Strength Index',
                'verbose_name_plural': 'Relative Strength Index',
                'proxy': True,
                'indexes': [],
                'constraints': [],
            },
            bases=('api.rsiindicator',),
        ),
        migrations.AlterField(
            model_name='accumulation',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='breakout',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='channel',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='downtrend',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='justbet4percent',
            name='name',
            field=models.CharField(help_text='Configuration name', max_length=255),
        ),
        migrations.AlterField(
            model_name='line',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='maxtradeperday',
            name='name',
            field=models.CharField(help_text='Configuration name', max_length=255),
        ),
        migrations.AlterField(
            model_name='onepercentofcapital',
            name='name',
            field=models.CharField(help_text='Configuration name', max_length=255),
        ),
        migrations.AlterField(
            model_name='onlytradereversal',
            name='name',
            field=models.CharField(help_text='Configuration name', max_length=255),
        ),
        migrations.AlterField(
            model_name='resistance',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='sideways',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='support',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='trendline',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.AlterField(
            model_name='uptrend',
            name='argument',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)ss', to='api.argument'),
        ),
        migrations.CreateModel(
            name='PatternCatalog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('is_active', models.BooleanField(default=True, help_text='Indicates if this record is active')),
                ('pattern_code', models.CharField(max_length=32, unique=True)),
                ('name', models.CharField(max_length=128)),
                ('category', models.CharField(choices=[('CHART', 'Chart'), ('CANDLESTICK', 'Candlestick'), ('HARMONIC', 'Harmonic'), ('ELLIOTT', 'Elliott Wave'), ('WYCKOFF', 'Wyckoff'), ('INDICATOR', 'Indicator'), ('CYCLE', 'Cyclical'), ('HYBRID', 'Hybrid')], max_length=16)),
                ('direction_bias', models.CharField(choices=[('BULLISH', 'Bullish'), ('BEARISH', 'Bearish'), ('CONTINUATION', 'Continuation'), ('NEUTRAL', 'Neutral')], default='NEUTRAL', max_length=16)),
                ('min_bars', models.PositiveIntegerField(default=1)),
                ('max_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('min_touches', models.PositiveIntegerField(default=0)),
                ('requires_gap', models.BooleanField(default=False)),
                ('fib_tolerance_pct', models.DecimalField(blank=True, decimal_places=2, help_text='Tolerance percentage for Fibonacci-derived rules', max_digits=5, null=True)),
                ('default_confirmation_rule', models.TextField(blank=True, default='')),
                ('default_invalidation_rule', models.TextField(blank=True, default='')),
                ('theory_notes', models.TextField(blank=True, default='')),
                ('references', models.TextField(blank=True, default='')),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('client', models.ForeignKey(blank=True, help_text='Client that owns this record', null=True, on_delete=django.db.models.deletion.SET_NULL, to='clients.client')),
            ],
            options={
                'verbose_name': 'Pattern Catalog Entry',
                'verbose_name_plural': 'Pattern Catalog',
                'ordering': ['pattern_code'],
            },
        ),
        migrations.CreateModel(
            name='PatternInstance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('is_active', models.BooleanField(default=True, help_text='Indicates if this record is active')),
                ('timeframe', models.CharField(default='1h', max_length=16)),
                ('start_ts', models.DateTimeField()),
                ('end_ts', models.DateTimeField(blank=True, null=True)),
                ('breakout_ts', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('FORMING', 'Forming'), ('CONFIRMED', 'Confirmed'), ('FAILED', 'Failed'), ('INVALIDATED', 'Invalidated'), ('TARGET_HIT', 'Target Hit'), ('EXPIRED', 'Expired')], default='FORMING', max_length=16)),
                ('trend_precondition', models.CharField(blank=True, choices=[('UPTREND', 'Uptrend'), ('DOWNTREND', 'Downtrend'), ('SIDEWAYS', 'Sideways')], default='', max_length=16)),
                ('pre_pattern_return_pct', models.DecimalField(blank=True, decimal_places=2, help_text='Percentage return leading into the pattern', max_digits=7, null=True)),
                ('pre_pattern_atr', models.DecimalField(blank=True, decimal_places=4, help_text='ATR level before the pattern started', max_digits=10, null=True)),
                ('vol_regime_z', models.DecimalField(blank=True, decimal_places=3, help_text='Z-score of volume regime prior to detection', max_digits=6, null=True)),
                ('volume_profile', models.CharField(blank=True, choices=[('RISING', 'Rising'), ('FALLING', 'Falling'), ('MIXED', 'Mixed')], default='', max_length=8)),
                ('breakout_direction', models.CharField(choices=[('UP', 'Up'), ('DOWN', 'Down'), ('NONE', 'None')], default='NONE', max_length=8)),
                ('breakout_volume_z', models.DecimalField(blank=True, decimal_places=3, help_text='Volume Z-score at breakout', max_digits=6, null=True)),
                ('climax_volume_flag', models.BooleanField(default=False)),
                ('confirm_method', models.CharField(blank=True, choices=[('CLOSE', 'Close'), ('INTRABAR', 'Intrabar'), ('VOLUME', 'Volume'), ('RETEST', 'Retest'), ('STRUCTURE', 'Structure')], default='', max_length=16)),
                ('confirm_strength', models.DecimalField(blank=True, decimal_places=2, help_text='Strength score [0-1] for confirmation', max_digits=5, null=True)),
                ('invalidation_level', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('measured_move', models.DecimalField(blank=True, decimal_places=8, help_text='Measured move projection in price units', max_digits=20, null=True)),
                ('tp1', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('tp2', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('tp3', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('stop_method', models.CharField(blank=True, choices=[('SWING', 'Swing'), ('STRUCTURE', 'Structure'), ('ATR', 'ATR'), ('VWAP', 'VWAP'), ('CUSTOM', 'Custom')], default='', max_length=16)),
                ('r_multiple_plan', models.JSONField(blank=True, default=dict, help_text='Serialized plan for R multiple management')),
                ('pattern_score', models.DecimalField(decimal_places=2, default=0.0, help_text='Composite pattern quality score (0-100)', max_digits=5)),
                ('reliability_est', models.DecimalField(blank=True, decimal_places=2, help_text='Estimated reliability (0-1)', max_digits=5, null=True)),
                ('historical_winrate_est', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('edge_z', models.DecimalField(blank=True, decimal_places=3, help_text='Statistical edge score (Z)', max_digits=6, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('htf_alignment', models.CharField(choices=[('NONE', 'None'), ('WEAK', 'Weak'), ('STRONG', 'Strong')], default='NONE', max_length=8)),
                ('htf_trend', models.CharField(blank=True, default='', max_length=32)),
                ('lt_tf_confirm', models.BooleanField(default=False)),
                ('detected_version', models.CharField(blank=True, default='', max_length=32)),
                ('features', models.JSONField(blank=True, default=dict, help_text='Flexible storage for detector-specific metrics')),
                ('client', models.ForeignKey(blank=True, help_text='Client that owns this record', null=True, on_delete=django.db.models.deletion.SET_NULL, to='clients.client')),
                ('pattern', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='instances', to='api.patterncatalog')),
                ('symbol', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pattern_instances', to='api.symbol')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PatternAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('is_active', models.BooleanField(default=True, help_text='Indicates if this record is active')),
                ('alert_ts', models.DateTimeField(auto_now_add=True)),
                ('alert_type', models.CharField(choices=[('FORMING', 'Forming'), ('CONFIRM', 'Confirm'), ('RETEST', 'Retest'), ('INVALIDATE', 'Invalidate'), ('TARGET_HIT', 'Target Hit')], max_length=16)),
                ('confidence', models.DecimalField(decimal_places=2, default=0.0, help_text='Confidence at alert generation', max_digits=5)),
                ('payload', models.JSONField(blank=True, default=dict)),
                ('client', models.ForeignKey(blank=True, help_text='Client that owns this record', null=True, on_delete=django.db.models.deletion.SET_NULL, to='clients.client')),
                ('instance', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alerts', to='api.patterninstance')),
            ],
            options={
                'ordering': ['-alert_ts'],
            },
        ),
        migrations.CreateModel(
            name='IndicatorPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('indicator_type', models.CharField(blank=True, choices=[('RSI', 'RSI'), ('MACD', 'MACD'), ('STOCH', 'Stochastic'), ('OBV', 'On-Balance Volume'), ('MOMENTUM', 'Momentum')], default='', max_length=16)),
                ('rsi_value', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('rsi_divergence', models.CharField(blank=True, default='', max_length=8)),
                ('failure_swing', models.BooleanField(default=False)),
                ('macd', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('macd_signal', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('macd_hist', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('macd_cross', models.CharField(blank=True, default='', max_length=8)),
                ('stoch_k', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('stoch_d', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('stoch_cross', models.CharField(blank=True, default='', max_length=8)),
                ('obv_slope', models.DecimalField(blank=True, decimal_places=4, max_digits=7, null=True)),
                ('momentum_z', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('features', models.JSONField(blank=True, default=dict)),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='indicator_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Indicator Pattern Detail',
                'verbose_name_plural': 'Indicator Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='HarmonicPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('ratio_ab_xa', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('ratio_bc_ab', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('ratio_cd_bc', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('ratio_ad_xa', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('ratio_tolerance_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('prz_min', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('prz_max', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('prz_width_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('confluence_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('completion_ts', models.DateTimeField(blank=True, null=True)),
                ('completion_price', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('completion_distance_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('symmetry_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('time_ratio_alignment', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('volume_confirmation', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('features', models.JSONField(blank=True, default=dict)),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='harmonic_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Harmonic Pattern Detail',
                'verbose_name_plural': 'Harmonic Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='ElliottPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('degree', models.CharField(blank=True, choices=[('PRIMARY', 'Primary'), ('INTERMEDIATE', 'Intermediate'), ('MINOR', 'Minor'), ('MINUETTE', 'Minuette'), ('SUB_MINUETTE', 'Sub-Minuette')], default='', max_length=16)),
                ('wave_labels', models.JSONField(blank=True, default=list, help_text='Ordered labels for detected waves (1-5, A-C)')),
                ('rule_2_not_exceed_1_start', models.BooleanField(default=True)),
                ('rule_3_not_shortest', models.BooleanField(default=True)),
                ('overlap_rule_ok', models.BooleanField(default=True)),
                ('wave3_extension', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('wave5_extension', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('abc_ratios', models.JSONField(blank=True, default=dict)),
                ('subwave_confidence', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('count_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('features', models.JSONField(blank=True, default=dict)),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='elliott_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Elliott Pattern Detail',
                'verbose_name_plural': 'Elliott Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='CyclicalPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('window_start_ts', models.DateTimeField(blank=True, null=True)),
                ('window_end_ts', models.DateTimeField(blank=True, null=True)),
                ('cycle_length_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('historical_hit_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('avg_return_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('p_value', models.DecimalField(blank=True, decimal_places=4, max_digits=6, null=True)),
                ('regime_dependency', models.CharField(choices=[('NONE', 'None'), ('WEAK', 'Weak'), ('STRONG', 'Strong')], default='NONE', max_length=8)),
                ('event_tag', models.CharField(blank=True, default='', max_length=64)),
                ('notes', models.TextField(blank=True, default='')),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='cyclical_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Cyclical Pattern Detail',
                'verbose_name_plural': 'Cyclical Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='ChartPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('upper_line_type', models.CharField(blank=True, choices=[('FLAT', 'Flat'), ('RISING', 'Rising'), ('FALLING', 'Falling')], default='', max_length=8)),
                ('lower_line_type', models.CharField(blank=True, choices=[('FLAT', 'Flat'), ('RISING', 'Rising'), ('FALLING', 'Falling')], default='', max_length=8)),
                ('apex_ts', models.DateTimeField(blank=True, null=True)),
                ('apex_distance_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('channel_parallelism', models.DecimalField(blank=True, decimal_places=2, help_text='Parallelism score [0-1]', max_digits=5, null=True)),
                ('height_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('range_compression_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('handle_depth_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('megaphone_divergence_rate', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('touches_top', models.PositiveSmallIntegerField(default=0)),
                ('touches_bottom', models.PositiveSmallIntegerField(default=0)),
                ('symmetry_score', models.DecimalField(blank=True, decimal_places=2, help_text='Symmetry score [0-1]', max_digits=5, null=True)),
                ('linearity_r2_top', models.DecimalField(blank=True, decimal_places=3, max_digits=5, null=True)),
                ('linearity_r2_bottom', models.DecimalField(blank=True, decimal_places=3, max_digits=5, null=True)),
                ('slope_top', models.DecimalField(blank=True, decimal_places=6, max_digits=10, null=True)),
                ('slope_bottom', models.DecimalField(blank=True, decimal_places=6, max_digits=10, null=True)),
                ('height_at_breakout', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('width_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('contraction_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('neckline_slope', models.DecimalField(blank=True, decimal_places=6, max_digits=10, null=True)),
                ('head_prominence_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('shoulder_symmetry', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('peak_trough_distance_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('variance_between_peaks', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('curvature_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('duration_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('flag_pole_return_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('flag_slope', models.DecimalField(blank=True, decimal_places=6, max_digits=10, null=True)),
                ('flag_ratio', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('channel_width_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('divergence_rate', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('swing_amplitude_growth', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('impulse_strength_z', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('trend_len_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('breakout_close_rel_band', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('post_breakout_atr_mult', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='chart_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Chart Pattern Detail',
                'verbose_name_plural': 'Chart Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='CandlestickPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('candle_count', models.PositiveSmallIntegerField(default=1)),
                ('body_pct_main', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('upper_wick_pct_main', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('lower_wick_pct_main', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('real_body_vs_atr', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('gap_direction', models.CharField(choices=[('UP', 'Gap Up'), ('DOWN', 'Gap Down'), ('NONE', 'No Gap')], default='NONE', max_length=8)),
                ('prior_trend_len_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('prior_return_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('location_in_range', models.CharField(blank=True, choices=[('TOP', 'Top'), ('MIDDLE', 'Middle'), ('BOTTOM', 'Bottom')], default='', max_length=8)),
                ('volume_z', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('engulf_ratio', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('open_within_prev_body', models.BooleanField(default=False)),
                ('close_vs_midpoint_prev', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('pattern_sequence', models.JSONField(blank=True, default=list)),
                ('wick_ratio_sequence', models.JSONField(blank=True, default=list)),
                ('color_sequence', models.JSONField(blank=True, default=list)),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='candlestick_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Candlestick Pattern Detail',
                'verbose_name_plural': 'Candlestick Pattern Details',
            },
        ),
        migrations.CreateModel(
            name='PatternOutcome',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('is_active', models.BooleanField(default=True, help_text='Indicates if this record is active')),
                ('evaluation_window_bars', models.PositiveIntegerField(default=0)),
                ('max_favorable_excursion', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('max_adverse_excursion', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True)),
                ('hit_tp1', models.BooleanField(default=False)),
                ('hit_tp2', models.BooleanField(default=False)),
                ('hit_tp3', models.BooleanField(default=False)),
                ('stopped_out', models.BooleanField(default=False)),
                ('peak_return_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=7, null=True)),
                ('time_to_target_bars', models.PositiveIntegerField(blank=True, null=True)),
                ('client', models.ForeignKey(blank=True, help_text='Client that owns this record', null=True, on_delete=django.db.models.deletion.SET_NULL, to='clients.client')),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='outcome', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Pattern Outcome',
                'verbose_name_plural': 'Pattern Outcomes',
            },
        ),
        migrations.CreateModel(
            name='PatternPoint',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('is_active', models.BooleanField(default=True, help_text='Indicates if this record is active')),
                ('label', models.CharField(max_length=16)),
                ('ts', models.DateTimeField()),
                ('price', models.DecimalField(decimal_places=8, max_digits=20)),
                ('bar_index_offset', models.IntegerField(blank=True, help_text='Offset relative to pattern start', null=True)),
                ('role', models.CharField(blank=True, default='', max_length=32)),
                ('client', models.ForeignKey(blank=True, help_text='Client that owns this record', null=True, on_delete=django.db.models.deletion.SET_NULL, to='clients.client')),
                ('instance', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='points', to='api.patterninstance')),
            ],
            options={
                'ordering': ['ts'],
            },
        ),
        migrations.CreateModel(
            name='WyckoffPatternDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Record creation timestamp')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Last update timestamp')),
                ('phase', models.CharField(blank=True, choices=[('A', 'Phase A'), ('B', 'Phase B'), ('C', 'Phase C'), ('D', 'Phase D'), ('E', 'Phase E')], default='', max_length=1)),
                ('event', models.CharField(blank=True, choices=[('SC', 'Selling Climax'), ('AR', 'Automatic Rally'), ('ST', 'Secondary Test'), ('SPRING', 'Spring'), ('TEST', 'Test'), ('SOS', 'Sign of Strength'), ('LPS', 'Last Point of Support'), ('UT', 'Upthrust'), ('UTAD', 'Upthrust After Distribution'), ('OTHER', 'Other')], default='', max_length=8)),
                ('trading_range_top', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('trading_range_bottom', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('spring_depth_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('upthrust_depth_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('climactic_volume', models.BooleanField(default=False)),
                ('effort_vs_result_z', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('pf_count_projection', models.DecimalField(blank=True, decimal_places=8, max_digits=20, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('instance', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='wyckoff_detail', to='api.patterninstance')),
            ],
            options={
                'verbose_name': 'Wyckoff Pattern Detail',
                'verbose_name_plural': 'Wyckoff Pattern Details',
            },
        ),
        migrations.DeleteModel(
            name='Engulfing',
        ),
        migrations.DeleteModel(
            name='EveningStar',
        ),
        migrations.DeleteModel(
            name='Hammer',
        ),
        migrations.DeleteModel(
            name='HangingMan',
        ),
        migrations.DeleteModel(
            name='InvertedHammer',
        ),
        migrations.DeleteModel(
            name='MorningStar',
        ),
        migrations.DeleteModel(
            name='Piercing',
        ),
        migrations.DeleteModel(
            name='Rectangle',
        ),
        migrations.DeleteModel(
            name='ShootingStar',
        ),
        migrations.DeleteModel(
            name='Triangle',
        ),
        migrations.AddIndex(
            model_name='patterninstance',
            index=models.Index(fields=['symbol', 'status', 'breakout_ts'], name='api_pattern_symbol__2f78a4_idx'),
        ),
        migrations.AddIndex(
            model_name='patterninstance',
            index=models.Index(fields=['pattern', 'status'], name='api_pattern_pattern_a8717d_idx'),
        ),
    ]
